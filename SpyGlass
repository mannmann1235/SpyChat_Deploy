<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Real Estate AI Assistant</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
      min-height: 100vh;
      color: #f1f5f9;
      padding: 20px;
    }

    .container {
      max-width: 1000px;
      margin: 0 auto;
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
    }

    .header-icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
      margin-bottom: 10px;
    }

    .icon-box {
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 10px 30px rgba(139, 92, 246, 0.4);
    }

    .gradient-text {
      font-size: 2.5rem;
      font-weight: bold;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .subtitle {
      color: #94a3b8;
      font-size: 0.9rem;
    }

    .chat-container {
      background: rgba(15, 23, 42, 0.6);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(148, 163, 184, 0.1);
      border-radius: 24px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
      overflow: hidden;
      margin-bottom: 25px;
    }

    .chat-box {
      height: 500px;
      overflow-y: auto;
      padding: 25px;
    }

    .empty-state {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
      text-align: center;
    }

    .empty-icon {
      font-size: 4rem;
      margin-bottom: 20px;
      opacity: 0.5;
    }

    .empty-title {
      font-size: 1.3rem;
      color: #cbd5e1;
      margin-bottom: 10px;
    }

    .empty-desc {
      color: #64748b;
      max-width: 500px;
    }

    .message {
      display: flex;
      margin-bottom: 15px;
      animation: fadeIn 0.4s ease-out;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .message.user {
      justify-content: flex-end;
    }

    .message.assistant {
      justify-content: flex-start;
    }

    .message-content {
      max-width: 80%;
      padding: 15px 20px;
      border-radius: 16px;
    }

    .message.user .message-content {
      background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
    }

    .message.assistant .message-content {
      background: rgba(15, 23, 42, 0.6);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(148, 163, 184, 0.1);
      color: #e2e8f0;
    }

    .typing-indicator {
      display: none;
      justify-content: flex-start;
      margin-bottom: 15px;
    }

    .typing-indicator.show {
      display: flex;
    }

    .typing-dots {
      background: rgba(15, 23, 42, 0.6);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(148, 163, 184, 0.1);
      padding: 15px 20px;
      border-radius: 16px;
      display: flex;
      gap: 6px;
    }

    .typing-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      animation: pulse 1.5s ease-in-out infinite;
    }

    .typing-dot:nth-child(1) {
      background: #8b5cf6;
      animation-delay: 0s;
    }

    .typing-dot:nth-child(2) {
      background: #7c3aed;
      animation-delay: 0.2s;
    }

    .typing-dot:nth-child(3) {
      background: #8b5cf6;
      animation-delay: 0.4s;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.3; }
    }

    .quick-questions {
      margin-bottom: 25px;
    }

    .quick-title {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 12px;
      font-size: 0.85rem;
      color: #94a3b8;
    }

    .quick-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .thought-btn {
      background: rgba(15, 23, 42, 0.6);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(148, 163, 184, 0.1);
      padding: 10px 16px;
      border-radius: 12px;
      color: #cbd5e1;
      font-size: 0.85rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .thought-btn:hover {
      border-color: rgba(139, 92, 246, 0.5);
      color: #c4b5fd;
      box-shadow: 0 4px 15px rgba(139, 92, 246, 0.2);
    }

    .input-container {
      position: relative;
    }

    .input-wrapper {
      background: rgba(15, 23, 42, 0.6);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(148, 163, 184, 0.1);
      border-radius: 16px;
      padding: 8px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .input-field-wrapper {
      flex: 1;
      position: relative;
    }

    #userInput {
      width: 100%;
      background: transparent;
      border: none;
      outline: none;
      color: #e2e8f0;
      padding: 12px 16px;
      font-size: 1rem;
    }

    #userInput::placeholder {
      color: #64748b;
    }

    .suggestions {
      position: absolute;
      bottom: calc(100% + 10px);
      left: 0;
      right: 0;
      background: rgba(15, 23, 42, 0.95);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(148, 163, 184, 0.1);
      border-radius: 12px;
      max-height: 250px;
      overflow-y: auto;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
      display: none;
    }

    .suggestions.show {
      display: block;
    }

    .suggestion-item {
      padding: 12px 16px;
      color: #cbd5e1;
      font-size: 0.9rem;
      cursor: pointer;
      border-bottom: 1px solid rgba(148, 163, 184, 0.1);
      transition: all 0.15s;
    }

    .suggestion-item:last-child {
      border-bottom: none;
    }

    .suggestion-item:hover {
      background: rgba(100, 116, 139, 0.15);
      border-color: rgba(148, 163, 184, 0.3);
    }

    .send-btn {
      background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
      border: none;
      color: white;
      padding: 12px 16px;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s;
      font-size: 1.1rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .send-btn:hover:not(:disabled) {
      box-shadow: 0 4px 15px rgba(139, 92, 246, 0.5);
      transform: translateY(-1px);
    }

    .send-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="header-icon">
        <div class="icon-box">üè†</div>
        <h1 class="gradient-text">Real Estate AI</h1>
      </div>
      <p class="subtitle">Powered by Ryan Rodenbeck's Knowledge Base</p>
    </div>

    <div class="chat-container">
      <div class="chat-box" id="chatBox">
        <div class="empty-state" id="emptyState">
          <div class="empty-icon">‚ú®</div>
          <h3 class="empty-title">Welcome to Real Estate AI</h3>
          <p class="empty-desc">Ask me about property investing, flipping strategies, TREC regulations, or Texas real estate law.</p>
        </div>
      </div>
    </div>

    <div class="quick-questions" id="quickQuestions">
      <div class="quick-title">
        <span>‚ú®</span>
        <span>Quick Questions</span>
      </div>
      <div class="quick-buttons" id="thoughtButtons"></div>
    </div>

    <div class="input-container">
      <div class="input-wrapper">
        <div class="input-field-wrapper">
          <input type="text" id="userInput" placeholder="">
          <div class="suggestions" id="suggestions"></div>
        </div>
        <button class="send-btn" id="sendBtn" disabled>‚û§</button>
      </div>
    </div>
  </div>

  <script>
    const knowledgeBase = [
      { q: "How do interest rates affect property resale in 6 months?", a: "When Federal Reserve rates rise, short-term buyer demand and resale margins fall. Within 6 months, mortgage rate volatility directly impacts the property's exit value." },
      { q: "What's the best metric for a 6-month flip - cap rate, IRR, or ROI?", a: "ROI is most relevant since it measures realized gains over total costs in a short period, while IRR is more suitable for multi-year projections." },
      { q: "How does AI predict property price movements monthly?", a: "AI uses rolling window regression based on neighborhood comps, listing velocity, and keyword sentiment to forecast price movements every 30 days." },
      { q: "What is rental yield compression and why does it matter?", a: "When rental yield compresses (declines), it means capital values are rising‚Äîgood for short-term selling, but risky if demand is purely speculative." },
      { q: "Why is market liquidity score important for short holds?", a: "With a short horizon, how quickly a property can be sold matters; a high liquidity score reduces the risk of capital lock-in." },
      { q: "Can I recover capital before my 6-month hold ends?", a: "Through blockchain tokenization, investors can sell fractional property shares on secondary markets without selling the entire asset‚Äîproviding mid-term liquidity." },
      { q: "How does unemployment affect rental repricing decisions?", a: "Unemployment rate has a lag effect of 1-2 months; when it rises, rental repricing should adjust downward quickly to maintain occupancy rates." },
      { q: "What does TREC do in Texas real estate?", a: "The Texas Real Estate Commission regulates and enforces laws for real estate professionals to protect consumer interests and ensure fair market practices." },
      { q: "How does TREC ensure agent integrity?", a: "TREC upholds integrity through mandatory education, background checks, audits, and disciplinary actions against violations of the Texas Occupations Code." },
      { q: "What is the Recovery Trust Account?", a: "The Recovery Trust Account provides financial compensation to consumers who suffer losses from fraudulent or negligent acts by licensed agents." },
      { q: "What's the difference between fee simple and leasehold?", a: "A fee simple absolute gives full ownership rights with no time limit, while a leasehold estate grants possession for a fixed term. This affects valuation, financing, and resale potential." },
      { q: "How do you determine highest and best use of land?", a: "You assess zoning, permitted uses, market demand, site constraints, and economic feasibility. This determines whether current land use is optimal and impacts appraisal and listing strategy." },
      { q: "What risk exists with undisclosed liens?", a: "The buyer's agent risks legal liability if proper title verification is not performed. Mitigation includes title search, title insurance, escrow protection, and client disclosure." },
      { q: "How do you calculate property tax proration at closing?", a: "Divide the annual tax by 365 days and multiply by the number of days each party owned the property. The seller covers their portion up to closing, and the buyer assumes responsibility thereafter." }
    ];

    const placeholders = [
      'How do interest rates affect flipping?',
      'What is the best metric for 6-month flip?',
      'Can AI predict property prices?',
      'What is rental yield compression?',
      'Why is liquidity score important?',
      'How does tokenization work?',
      'What does TREC regulate?',
      'What is fee simple vs leasehold?',
      'How to calculate tax proration?',
      'What are undisclosed lien risks?'
    ];

    let availableThoughts = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13];
    const chatBox = document.getElementById('chatBox');
    const emptyState = document.getElementById('emptyState');
    const userInput = document.getElementById('userInput');
    const sendBtn = document.getElementById('sendBtn');
    const suggestionsBox = document.getElementById('suggestions');
    const thoughtButtons = document.getElementById('thoughtButtons');

    // Typing effect for placeholder
    let currentIndex = 0;
    let charIndex = 0;
    let isDeleting = false;

    function typeEffect() {
      if (userInput.value !== '') {
        userInput.placeholder = '';
        return;
      }

      const current = placeholders[currentIndex];

      if (!isDeleting) {
        userInput.placeholder = current.substring(0, charIndex + 1);
        charIndex++;

        if (charIndex === current.length) {
          setTimeout(() => { isDeleting = true; typeEffect(); }, 2000);
          return;
        }
      } else {
        userInput.placeholder = current.substring(0, charIndex - 1);
        charIndex--;

        if (charIndex === 0) {
          isDeleting = false;
          currentIndex = (currentIndex + 1) % placeholders.length;
        }
      }

      setTimeout(typeEffect, isDeleting ? 30 : 80);
    }

    setTimeout(typeEffect, 500);

    // Render thought buttons
    function renderThoughts() {
      thoughtButtons.innerHTML = '';
      availableThoughts.slice(0, 4).forEach(idx => {
        const btn = document.createElement('button');
        btn.className = 'thought-btn';
        btn.textContent = knowledgeBase[idx].q;
        btn.onclick = () => handleThoughtClick(idx);
        thoughtButtons.appendChild(btn);
      });
    }

    renderThoughts();

    // Add message
    function addMessage(role, content) {
      emptyState.style.display = 'none';
      
      const msgDiv = document.createElement('div');
      msgDiv.className = `message ${role}`;
      
      const contentDiv = document.createElement('div');
      contentDiv.className = 'message-content';
      contentDiv.textContent = content;
      
      msgDiv.appendChild(contentDiv);
      
      const typingIndicator = document.getElementById('typingIndicator');
      if (typingIndicator) {
        chatBox.removeChild(typingIndicator);
      }
      
      chatBox.appendChild(msgDiv);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    // Show typing indicator
    function showTyping() {
      const typing = document.createElement('div');
      typing.id = 'typingIndicator';
      typing.className = 'typing-indicator show';
      typing.innerHTML = `
        <div class="typing-dots">
          <div class="typing-dot"></div>
          <div class="typing-dot"></div>
          <div class="typing-dot"></div>
        </div>
      `;
      chatBox.appendChild(typing);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    // Handle thought click
    function handleThoughtClick(idx) {
      const kb = knowledgeBase[idx];
      addMessage('user', kb.q);
      showTyping();
      
      setTimeout(() => {
        addMessage('assistant', kb.a);
      }, 500);
      
      availableThoughts = availableThoughts.filter(t => t !== idx);
      renderThoughts();
    }

    // Handle input
    userInput.addEventListener('input', (e) => {
      const value = e.target.value;
      sendBtn.disabled = !value.trim();

      if (value.trim().length >= 2) {
        const query = value.toLowerCase();
        const matches = knowledgeBase
          .map((kb, idx) => {
            const qLower = kb.q.toLowerCase();
            if (qLower.includes(query)) return { idx, q: kb.q };
            const words = query.split(' ');
            if (words.some(w => w.length > 2 && qLower.includes(w))) return { idx, q: kb.q };
            return null;
          })
          .filter(m => m !== null)
          .slice(0, 5);

        if (matches.length > 0) {
          suggestionsBox.innerHTML = matches.map(m => 
            `<div class="suggestion-item" data-idx="${m.idx}">${m.q}</div>`
          ).join('');
          suggestionsBox.classList.add('show');

          suggestionsBox.querySelectorAll('.suggestion-item').forEach(item => {
            item.addEventListener('click', () => {
              const idx = parseInt(item.dataset.idx);
              handleThoughtClick(idx);
              userInput.value = '';
              sendBtn.disabled = true;
              suggestionsBox.classList.remove('show');
            });
          });
        } else {
          suggestionsBox.classList.remove('show');
        }
      } else {
        suggestionsBox.classList.remove('show');
      }
    });

    // Handle send
    function handleSend() {
      const query = userInput.value.trim();
      if (!query) return;

      const queryLower = query.toLowerCase();
      let answer = "I'm focused on real estate investment strategies, property flipping, TREC regulations, and Texas real estate law. Could you rephrase your question about these topics?";

      for (let kb of knowledgeBase) {
        const qLower = kb.q.toLowerCase();
        if (
          (queryLower.includes('interest') || queryLower.includes('rate')) && qLower.includes('interest') ||
          (queryLower.includes('roi') || queryLower.includes('irr') || queryLower.includes('metric')) && qLower.includes('metric') ||
          queryLower.includes('ai') && qLower.includes('ai') ||
          queryLower.includes('rental yield') && qLower.includes('rental yield') ||
          queryLower.includes('liquidity') && qLower.includes('liquidity') ||
          queryLower.includes('token') && qLower.includes('token') ||
          queryLower.includes('unemploy') && qLower.includes('unemployment') ||
          queryLower.includes('trec') && qLower.includes('trec') ||
          queryLower.includes('integrity') && qLower.includes('integrity') ||
          queryLower.includes('recovery') && qLower.includes('recovery') ||
          (queryLower.includes('fee simple') || queryLower.includes('leasehold')) && qLower.includes('fee simple') ||
          (queryLower.includes('highest') || queryLower.includes('best use')) && qLower.includes('highest') ||
          queryLower.includes('lien') && qLower.includes('lien') ||
          queryLower.includes('tax') && qLower.includes('proration')
        ) {
          answer = kb.a;
          break;
        }
      }

      addMessage('user', query);
      showTyping();
      
      setTimeout(() => {
        addMessage('assistant', answer);
      }, 500);

      userInput.value = '';
      sendBtn.disabled = true;
      suggestionsBox.classList.remove('show');
    }

    sendBtn.addEventListener('click', handleSend);
    userInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') handleSend();
    });
  </script>
</body>
</html>
